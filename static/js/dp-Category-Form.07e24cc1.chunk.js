"use strict";(self.webpackChunkmind=self.webpackChunkmind||[]).push([[850],{6291:function(e,t,n){n.r(t);var r=n(3508),a=n(6515),i=n(3032),s=n(3430),c=n(2791),o=n(5897),u=n(419),l=n(6106),d=n(8017),p=n(9034),f=n(1226),m=n(7856),x=n(7689),g=n(7106),h=n(2351),Z=n(184);t.default=function(){var e=(0,c.useState)({image:{src:"",isUpdated:!1},loading:!1,imageRespone:""}),t=(0,s.Z)(e,2),n=t[0],v=t[1],j=(0,x.s0)(),b=(0,x.UO)().categoryId,k=o.Z.useForm(),y=(0,s.Z)(k,1)[0];function w(e,t){var n=new FileReader;n.addEventListener("load",(function(){return t(n.result)})),n.readAsDataURL(e)}var F=(0,c.useState)({loading:!1,mode:"NEW",data:{}}),T=(0,s.Z)(F,2),I=T[0],N=T[1],O=[{icon:"IdcardOutlined",href:null,text:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438"},{icon:"ApartmentOutlined",href:f.W3.categories,text:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0443\u0434\u044b\u043d \u0436\u0430\u0433\u0441\u0430\u0430\u043b\u0442"},{icon:"FormOutlined",href:"/",text:"NEW"===I.mode?"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438 \u0431\u04af\u0440\u0442\u0433\u044d\u0445":"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438 \u0437\u0430\u0441\u0430\u0445"}],R=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.validateFields().then(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("EDIT"!==I.mode){e.next=5;break}return e.next=3,(0,m.GH)(f.W3.category,t);case 3:e.next=7;break;case 5:return e.next=7,(0,m.j0)(f.W3.category,(0,a.Z)((0,a.Z)({},t),{},{img:n.imageRespone}));case 7:u.ZP.success("\u041c\u044d\u0434\u044d\u044d\u043b\u043b\u0438\u0439\u0433 \u0430\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430."),j(f.W3.categoryes);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){N({loading:!1}),u.ZP.error(e.Message)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N({loading:!0}),e.next=4,(0,m.A_)("".concat(f.W3.category,"/").concat(t));case 4:n=e.sent,N({mode:"EDIT",loading:!1,data:n.data}),y.setFieldsValue(n.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),N({loading:!1});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var i,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.file,e.prev=1,s=new FormData,e.next=5,s.append("File",i.originFileObj);case 5:return e.next=7,(0,m.j0)(f.cT.uploadFile,s);case 7:if(c=e.sent,"uploading"!==i.status){e.next=11;break}return v((0,a.Z)((0,a.Z)({},n),{},{loading:!0,imageRespone:c.data})),e.abrupt("return");case 11:"done"===i.status&&w(i.originFileObj,(function(e){return v((0,a.Z)((0,a.Z)({},n),{},{image:{src:e,isUpdated:!0},loading:!1,imageRespone:c.data}))})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.log("caught an error"),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){"new"!==b&&W(b)}),[b]),(0,Z.jsx)(p.T3,{breadcrumb:O,children:(0,Z.jsx)(o.Z,{form:y,initialValues:{categoryId:""},layout:"vertical",children:(0,Z.jsxs)(l.Z,{gutter:[16],children:[(0,Z.jsx)(p.xJ,{label:"\u041d\u044d\u0440",name:"name",required:!0,span:8}),(0,Z.jsx)(p.xJ,{label:"\u0422\u0430\u0439\u043b\u0431\u0430\u0440",name:"desc",required:!0,span:8}),(0,Z.jsx)(o.Z.Item,{label:"\u0417\u0443\u0440\u0430\u0433",required:!0,children:(0,Z.jsx)(d.Z,{name:"avatar",listType:"picture-card",className:"rank-upload",showUploadList:!1,customRequest:function(e){var t=e.file,n=e.onSuccess;console.log("file->",t),setTimeout((function(){n("ok")}),.5)},onChange:q,children:n.image.src?(0,Z.jsx)("img",{src:n.image.src,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"contain"}}):(0,Z.jsxs)("div",{children:[n.loading?(0,Z.jsx)(g.Z,{}):(0,Z.jsx)(h.Z,{}),(0,Z.jsx)("div",{style:{marginTop:8},children:"\u0417\u0443\u0440\u0430\u0433 \u043e\u0440\u0443\u0443\u043b\u0430\u0445"})]})})}),(0,Z.jsx)(p.xJ,{label:"OrderNo",name:"orderNo",required:!0,span:8}),(0,Z.jsx)(p.xJ,{span:8,itemType:"select",label:"\u0422\u04e9\u043b\u04e9\u0432",name:"status",dtsrc:[{val:"A",txt:"\u0418\u0434\u044d\u0432\u0445\u0442\u044d\u0439",orderNo:1,filter:null,filter2:null},{val:"I",txt:"\u0418\u0434\u044d\u0432\u0445\u0433\u04af\u0439",orderNo:2,filter:null,filter2:null}],required:!0}),(0,Z.jsx)(p.xJ,{span:24,itemType:"button",onClick:function(){return R()}})]})})})}}}]);
//# sourceMappingURL=dp-Category-Form.07e24cc1.chunk.js.map